!function(){"use strict";class e{constructor(e,t,s,r,n,i){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDelIcon=r,this._handleFavIcon=n,this._handleDislike=i}_setEventListeners(){this._cardFavIcon.addEventListener("click",(()=>{this._isLiked?this._handleDislike(this):this._handleFavIcon(this)})),this._cardDelIcon.addEventListener("click",(()=>{this._handleDelIcon(this)})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this._link,this._name)}))}toggleFavIcon(){this._cardFavIcon.classList.toggle("card__favorite-button_pressed")}handleDelIcon(){this._cardElement.remove(),this._cardElement=null}getId(){return this._id}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector("#card-image"),this._cardTitleEl=this._cardElement.querySelector("#card-name"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._cardFavIcon=this._cardElement.querySelector(".card__favorite-button"),this._cardDelIcon=this._cardElement.querySelector(".card__delete-button"),this._isLiked?this._cardFavIcon.classList.add("card__favorite-button_pressed"):this._cardFavIcon.classList.remove("card__favorite-button_pressed"),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=this._form.querySelectorAll(this._inputSelector),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return Array.from(this._inputEls).some((e=>!e.validity.valid))}_disableButton(){this._submitButton&&(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_enableButton(){this._submitButton&&(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}disableSubmitButton(){this._disableButton()}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputEls.forEach((e=>{this._checkInputValidity(e)}))}}class s{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close-button"))&&this.close()}))}}class r extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitBtn=this._popupElement.querySelector(".modal__save-button"),this._submitBtnDefault=this._submitBtn.textContent,this._inputEls=this._popupForm.querySelectorAll(".modal__input"),this._handleFormSubmit=t}close(){this._popupForm.reset(),super.close()}_getInputValues(){const e={};return this._inputEls.forEach((t=>{e[t.name]=t.value})),e}renderLoading(e){this._submitBtn.textContent=e?"Saving...":this._submitBtnDefault}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const n={inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__error",errorClass:"modal__error_visible"},i=document.forms["profile-edit-form"],a=document.forms["profile-add-form"],o=document.forms["avatar-edit-form"],l=document.querySelector("#profile-avatar-btn"),d=document.querySelector("#profile-edit-btn"),c=document.querySelector("#profile-name-input"),h=document.querySelector("#profile-description-input"),_=document.querySelector("#profile-add-btn"),u=(document.querySelector(".cards__list"),new class{constructor(e,t,s){this._nameEl=document.querySelector(e),this._descriptionEl=document.querySelector(t),this._avatarEl=document.querySelector(s)}getUserInfo(){return{name:this._nameEl.textContent,description:this._descriptionEl.textContent,avatar:this._avatarEl.textContent}}setUserInfo(e,t){this._nameEl.textContent=e,this._descriptionEl.textContent=t}setUserAvatar(e){this._avatarEl.src=e}}("#profile-name","#profile-description","#profile-avatar")),m=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_resValidate(e){return e.ok?e.json():Promise.reject(`Error occured: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._resValidate)}setUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._resValidate)}getUserAvatar(){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"GET",headers:this._headers}).then(this._resValidate)}setUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._resValidate)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._resValidate)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._resValidate)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._resValidate)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._resValidate)}deleteLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._resValidate)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d116fd12-6c63-4575-acfb-58f1bbf2e648","Content-Type":"application/json"}}),p=new class{constructor(e,t){this._renderer=e,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{const t=this._renderer(e);this._container.append(t)}))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}((function(t){const s=new e(t,"#card-template",(function(e,t){f.open(e,t)}),(function(e){g.open(),g.setSubmitAction((()=>{g.renderLoading(!0),m.deleteCard(e.getId()).then((()=>{e.handleDelIcon(),g.close()})).catch(console.error).finally((()=>{g.renderLoading(!1)}))}))}),(function(e){m.addLike(e.getId()).then((()=>{s.toggleFavIcon()})).catch(console.error)}),(function(e){m.deleteLike(e.getId()).then((()=>{e.toggleFavIcon()})).catch(console.error)}));return s.getView()}),".cards__list");m.getInitialCards().then((e=>{p.renderItems(e)})).catch(console.error),m.getUserInfo().then((e=>{let{name:t,about:s,avatar:r}=e;u.setUserInfo(t,s),u.setUserAvatar(r)})).catch(console.error);const E=new t(n,i),v=new t(n,a),b=new t(n,o);E.enableValidation(),v.enableValidation(),b.enableValidation();const f=new class extends s{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".modal__image-preview"),this._popupName=this._popupElement.querySelector(".modal__name-preview")}open(e,t){this._popupImage.src=e,this._popupImage.alt=t,this._popupName.textContent=t,super.open()}}("#card-preview-modal");f.setEventListeners();const g=new class extends s{constructor(e){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitBtn=this._popupElement.querySelector(".modal__save-button"),this._submitBtnDefault=this._submitBtn.textContent}setSubmitAction(e){this._handleFormSubmit=e}renderLoading(e){this._submitBtn.textContent=e?"Deleting...":this._submitBtnDefault}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}}("#card-delete-modal");g.setEventListeners();const L=new r("#profile-add-modal",(e=>{L.renderLoading(!0),m.addCard(e).then((e=>{p.addItem(e),L.close(),v.toggleButtonState()})).catch(console.error).finally((()=>{L.renderLoading(!1)}))}));L.setEventListeners();const I=new r("#avatar-edit-modal",(e=>{I.renderLoading(!0),m.setUserAvatar(e).then((e=>{u.setUserAvatar(e.avatar),I.close(),b.toggleButtonState()})).catch(console.error).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners();const S=new r("#profile-edit-modal",(e=>{S.renderLoading(!0),m.setUserInfo(e).then((e=>{u.setUserInfo(e.name,e.about),S.close(),E.toggleButtonState()})).catch(console.error).finally((()=>{S.renderLoading(!1)}))}));S.setEventListeners(),_.addEventListener("click",(()=>{L.open()})),l.addEventListener("click",(()=>{I.open()})),d.addEventListener("click",(()=>{const{name:e,description:t}=u.getUserInfo();c.value=e,h.value=t,E.resetValidation(),S.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU1SLElBQ0xuQixFQUFTVyxjQUFjUSxFQUFJVixRQUMzQjRELEVBQWdCbEcsUUFDaEI4RixFQUF1QjNHLG1CQUFtQixJQUUzQ29HLE1BQU1DLFFBQVFDLE9BQ2RDLFNBQVEsS0FDUFEsRUFBZ0JoRixlQUFjLEVBQU0sR0FDcEMsSUFFTmdGLEVBQWdCL0Ysb0JBRWhCLE1BQU1pRyxFQUFtQixJQUFJOUYsRUFBYyx1QkFBd0IrRixJQUVqRUQsRUFBaUJsRixlQUFjLEdBQy9CdUIsRUFDR0YsWUFBWThELEdBQ1o3QyxNQUFNUixJQUNMbkIsRUFBU1UsWUFBWVMsRUFBSTlILEtBQU04SCxFQUFJMkMsT0FDbkNTLEVBQWlCcEcsUUFDakI0RixFQUFrQnpHLG1CQUFtQixJQUV0Q29HLE1BQU1DLFFBQVFDLE9BQ2RDLFNBQVEsS0FDUFUsRUFBaUJsRixlQUFjLEVBQU0sR0FDckMsSUFFTmtGLEVBQWlCakcsb0JBRWpCeUIsRUFBVzdGLGlCQUFpQixTQUFTLEtBQ25Da0ssRUFBYWxHLE1BQU0sSUFFckJ5QixFQUFpQnpGLGlCQUFpQixTQUFTLEtBQ3pDbUssRUFBZ0JuRyxNQUFNLElBR3hCMEIsRUFBZTFGLGlCQUFpQixTQUFTLEtBQ3ZDLE1BQU0sS0FBRWIsRUFBSSxZQUFFbUgsR0FBZ0JSLEVBQVNPLGNBQ3ZDVixFQUFpQlQsTUFBUS9GLEVBQ3pCeUcsRUFBd0JWLE1BQVFvQixFQUNoQ3VELEVBQWtCbkcsa0JBQ2xCMkcsRUFBaUJyRyxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FQSS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ2FyZERlbGV0ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGNhcmREYXRhLFxyXG5cclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxJY29uLFxyXG4gICAgaGFuZGxlRmF2SWNvbixcclxuICAgIGhhbmRsZURpc2xpa2VcclxuICApIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiY2FyZERhdGFcIiwgY2FyZERhdGEpO1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2lkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGNhcmREYXRhLmlzTGlrZWQ7XHJcblxyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxJY29uID0gaGFuZGxlRGVsSWNvbjtcclxuICAgIHRoaXMuX2hhbmRsZUZhdkljb24gPSBoYW5kbGVGYXZJY29uO1xyXG4gICAgdGhpcy5faGFuZGxlRGlzbGlrZSA9IGhhbmRsZURpc2xpa2U7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRmF2SWNvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURpc2xpa2UodGhpcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRmF2SWNvbih0aGlzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkRGVsSWNvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxJY29uKHRoaXMpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2xpbmssIHRoaXMuX25hbWUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVGYXZJY29uKCkge1xyXG4gICAgdGhpcy5fY2FyZEZhdkljb24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2Zhdm9yaXRlLWJ1dHRvbl9wcmVzc2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGVsSWNvbigpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICBjb25zdCBpZCA9IHRoaXMuX2lkO1xyXG4gICAgcmV0dXJuIGlkO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLW5hbWVcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgLy8gY29uc29sZS5sb2coXCJsaW5rXCIsIHRoaXMuX2xpbmspO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRGYXZJY29uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuY2FyZF9fZmF2b3JpdGUtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9jYXJkRGVsSWNvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9jYXJkRmF2SWNvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fZmF2b3JpdGUtYnV0dG9uX3ByZXNzZWRcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9jYXJkRmF2SWNvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fZmF2b3JpdGUtYnV0dG9uX3ByZXNzZWRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjYCArIGlucHV0RWwuaWQgKyBgLWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCNgICsgaW5wdXRFbC5pZCArIGAtZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9pbnB1dEVscykuc29tZShcclxuICAgICAgKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICBpZiAodGhpcy5fc3VibWl0QnV0dG9uKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIGlmICh0aGlzLl9zdWJtaXRCdXR0b24pIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0bkRlZmF1bHQgPSB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIC8vY29sbGVjdHMgZGF0YSBmcm9tIGlucHV0IGZpZWxkc1xyXG4gICAgY29uc3QgZm9ybURhdGEgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1EYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIC8vcmV0dXJucyBkYXRhIGFzIG9iamVjdFxyXG4gICAgcmV0dXJuIGZvcm1EYXRhO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0bkRlZmF1bHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3NhdmUtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0Rm9ybUVsID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWVkaXQtZm9ybVwiXTtcclxuZXhwb3J0IGNvbnN0IGFkZEZvcm1FbCA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1hZGQtZm9ybVwiXTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm1FbCA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWVkaXQtZm9ybVwiXTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ0blwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkQWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbi8vIGV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJDaHVyY2ggd2luZG93XCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tL29yaWdpbmFscy83YS84OS9lNC83YTg5ZTRkZWQ1OGJiODY1YzE3ZDAzYTRiYjBjNmExNC5wbmdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiTG9zdCBpbiB0aGUgV2lsZFwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS9vcmlnaW5hbHMvNGQvN2MvYWMvNGQ3Y2FjYmEyYWI4NjNjYzQwMWY1YzkxZDY1Njk5OWMucG5nXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxpZ2h0IGluIHRoZSBuaWdodFwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS9vcmlnaW5hbHMvMDgvYWIvZTUvMDhhYmU1YjIzZWExNjFjMzMwZjA0MDc4NWVlMjFmM2YucG5nXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkNvbnN0cnVjdGlvbiBncmlkXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tL29yaWdpbmFscy9kYy8xNC9iZS9kYzE0YmU2YjVjZjM4ZDUxNmFhMDc0MDY1M2ZjYmNiNi5wbmdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiU3RhaXJzXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaS5waW5pbWcuY29tL29yaWdpbmFscy8wNC81OS8yNC8wNDU5MjRjMjY4NWExNTkwMWY0NGRjYzU1OTk0MmFmZC5wbmdcIixcclxuLy8gICB9LFxyXG5cclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkFyY2hpdGVjdHVyZSBnZW9tZXRyeVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL2kucGluaW1nLmNvbS9vcmlnaW5hbHMvMjQvYWUvZmUvMjRhZWZlOGYyNDg0YzIyZDk4MWUwNTU4NzI3YjA2NTIucG5nXCIsXHJcbi8vICAgfSxcclxuLy8gXTtcclxuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BUEkuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cENhcmREZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDYXJkRGVsZXRlLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVkaXRGb3JtRWwsXHJcbiAgYWRkRm9ybUVsLFxyXG4gIGF2YXRhckZvcm1FbCxcclxuICBwcm9maWxlQXZhdGFyQnRuLFxyXG4gIHByb2ZpbGVFZGl0QnRuLFxyXG4gIHByb2ZpbGVOYW1lSW5wdXQsXHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXHJcbiAgY2FyZEFkZEJ0bixcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuLy8gVmFyaWFibGVzXHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcclxuICBcIiNwcm9maWxlLW5hbWVcIixcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uXCIsXHJcbiAgXCIjcHJvZmlsZS1hdmF0YXJcIlxyXG4pO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZDExNmZkMTItNmM2My00NTc1LWFjZmItNThmMWJiZjJlNjQ4XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oY3JlYXRlQ2FyZCwgXCIuY2FyZHNfX2xpc3RcIik7XHJcbmFwaVxyXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKHJlcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbmFwaVxyXG4gIC5nZXRVc2VySW5mbygpXHJcbiAgLnRoZW4oKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhuYW1lLCBhYm91dCk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGF2YXRhcik7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBlZGl0Rm9ybUVsKTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhZGRGb3JtRWwpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGF2YXRhckZvcm1FbCk7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlQXZhdGFyVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2NhcmQtcHJldmlldy1tb2RhbFwiKTtcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGNhcmREZWxldGVQb3B1cCA9IG5ldyBQb3B1cENhcmREZWxldGUoXCIjY2FyZC1kZWxldGUtbW9kYWxcIik7XHJcbmNhcmREZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1hZGQtbW9kYWxcIiwgKGxpbmspID0+IHtcclxuICBuZXdDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKGxpbmspXHJcblxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKHJlcyk7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59KTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmF0YXItZWRpdC1tb2RhbFwiLCAodXJsKSA9PiB7XHJcbiAgYXZhdGFyRWRpdFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIGFwaVxyXG4gICAgLnNldFVzZXJBdmF0YXIodXJsKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgICBhdmF0YXJFZGl0UG9wdXAuY2xvc2UoKTtcclxuICAgICAgcHJvZmlsZUF2YXRhclZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhdmF0YXJFZGl0UG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcbmF2YXRhckVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLCAodmFsdWVzKSA9PiB7XHJcbiAgLy8gdXNlckluZm8uc2V0VXNlckluZm8odmFsdWVzKTtcclxuICBwcm9maWxlRWRpdFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckluZm8odmFsdWVzKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0KTtcclxuICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBlZGl0Rm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlRWRpdFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5wcm9maWxlRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jYXJkQWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcbnByb2ZpbGVBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJFZGl0UG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGRlc2NyaXB0aW9uO1xyXG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHByb2ZpbGVFZGl0UG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbi8vIEZ1bmN0aW9uc1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIC8vIGNvbnNvbGUubG9nKFwiY2FyZEluZHhcIiwgY2FyZERhdGEpO1xyXG4gIGNvbnN0IGNhcmRFbCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcblxyXG4gICAgLy9oYW5kbGVzIEltYWdlIGNsaWNrXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcclxuICAgICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihuYW1lLCBsaW5rKTtcclxuICAgIH0sXHJcbiAgICAvL2hhbmRsZXMgRGVsZXRlIGJ1dHRvbiBjbGlja1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlRGVsZXRlQnRuKGNhcmRJbnN0YW5jZSkge1xyXG4gICAgICBjYXJkRGVsZXRlUG9wdXAub3BlbigpO1xyXG5cclxuICAgICAgY2FyZERlbGV0ZVBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZERlbGV0ZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZEluc3RhbmNlLmdldElkKCkpXHJcblxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkSW5zdGFuY2UuaGFuZGxlRGVsSWNvbigpO1xyXG4gICAgICAgICAgICBjYXJkRGVsZXRlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgY2FyZERlbGV0ZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8vaGFuZGxlcyBMaWtlIEJ1dHRvbiBDbGlja1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlRmF2SWNvbihjYXJkSW5zdGFuY2UpIHtcclxuICAgICAgYXBpXHJcbiAgICAgICAgLmFkZExpa2UoY2FyZEluc3RhbmNlLmdldElkKCkpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgY2FyZEVsLnRvZ2dsZUZhdkljb24oKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICAgIH0sXHJcbiAgICAvL3JlbW92ZXMgTGlrZSBCdXR0b25cclxuICAgIGZ1bmN0aW9uIGhhbmRsZURpc2xpa2UoY2FyZEluc3RhbmNlKSB7XHJcbiAgICAgIGFwaVxyXG4gICAgICAgIC5kZWxldGVMaWtlKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgIGNhcmRJbnN0YW5jZS50b2dnbGVGYXZJY29uKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbC5nZXRWaWV3KCk7XHJcbn1cclxuXHJcbi8vIGZ1bmN0aW9uIGRlbGV0ZUNhcmQoY2FyZCkge1xyXG4vLyAgIGNhcmREZWxldGVQb3B1cC5vcGVuKCk7XHJcbi8vICAgY2FyZERlbGV0ZVBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbi8vICAgICBhcGlcclxuLy8gICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5nZXRJZCgpKVxyXG4vLyAgICAgICAudGhlbigoKSA9PiB7XHJcbi8vICAgICAgICAgY2FyZERlbGV0ZVBvcHVwLmNsb3NlKCk7XHJcbi8vICAgICAgICAgY2FyZC5oYW5kbGVEZWxJY29uKCk7XHJcbi8vICAgICAgIH0pXHJcbi8vICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbi8vICAgICAgICAgY29uc29sZS5lcnJvcihgU29tZXRoaW5nIHdlbnQgd3Jvbmc6ICR7ZXJyfWApO1xyXG4vLyAgICAgICB9KTtcclxuLy8gICB9KTtcclxuLy8gfVxyXG5cclxuLy9BUElcclxuXHJcbi8vIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oY3JlYXRlQ2FyZCwgXCIuY2FyZHNfX2xpc3RcIik7XHJcbi8vIGFwaVxyXG4vLyAgIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4vLyAgIC50aGVuKChyZXMpID0+IHtcclxuLy8gICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKHJlcyk7XHJcbi8vICAgfSlcclxuLy8gICAuY2F0Y2goKGVycikgPT4ge1xyXG4vLyAgICAgY29uc29sZS5lcnJvcihgU29tZXRoaW5nIHdlbnQgd3Jvbmc6ICR7ZXJyfWApO1xyXG4vLyAgIH0pO1xyXG5cclxuLy8gY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuXHJcbi8vIGZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZm9ybURhdGEpIHtcclxuLy8gICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoeyBuYW1lOiBmb3JtRGF0YS50aXRsZSwgbGluazogZm9ybURhdGEudXJsIH0pKTtcclxuLy8gICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcclxuLy8gICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxuLy8gfVxyXG5cclxuLy8gZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoKSB7XHJcbi8vICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBwcm9maWxlTmFtZUlucHV0LnZhbHVlO1xyXG4vLyAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlO1xyXG4vLyAgIGVkaXRGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcclxuXHJcbi8vICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4vLyB9XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByb2ZpbGVOYW1lU2VsZWN0b3IsXHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb25TZWxlY3RvcixcclxuICAgIHByb2ZpbGVBdmF0YXJTZWxlY3RvclxyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlQXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIC8vIHJldHVybnMgb2JqZWN0IHdpdGggdXNlciBpbmZvXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWwudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9kZXNjcmlwdGlvbkVsLnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhckVsLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcbiAgc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcclxuICAgIC8vYWRkcyBkYXRhIHRvIHRoZSBwYWdlIGFmdGVyIHByb2ZpbGVGb3JtIHN1Ym1pdFxyXG4gICAgdGhpcy5fbmFtZUVsLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuICB9XHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9yZXNWYWxpZGF0ZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yIG9jY3VyZWQ6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Jlc1ZhbGlkYXRlKTtcclxuICB9XHJcbiAgc2V0VXNlckluZm8oaW5mbykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoaW5mbyksXHJcbiAgICB9KS50aGVuKHRoaXMuX3Jlc1ZhbGlkYXRlKTtcclxuICB9XHJcbiAgZ2V0VXNlckF2YXRhcigpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fcmVzVmFsaWRhdGUpO1xyXG4gIH1cclxuICBzZXRVc2VyQXZhdGFyKG5hbWUpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShuYW1lKSxcclxuICAgIH0pLnRoZW4odGhpcy5fcmVzVmFsaWRhdGUpO1xyXG4gIH1cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fcmVzVmFsaWRhdGUpO1xyXG4gIH1cclxuICBhZGRDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9yZXNWYWxpZGF0ZSk7XHJcbiAgfVxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Jlc1ZhbGlkYXRlKTtcclxuICB9XHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fcmVzVmFsaWRhdGUpO1xyXG4gIH1cclxuICBkZWxldGVMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9yZXNWYWxpZGF0ZSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZGF0YSkge1xyXG4gICAgLy8gZGVidWdnZXI7XHJcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5fcmVuZGVyZXIoZGF0YSk7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9faW1hZ2UtcHJldmlld1wiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcG9wdXBOYW1lID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX25hbWUtcHJldmlld1wiKTtcclxuICB9XHJcbiAgb3BlbihsaW5rLCBuYW1lKSB7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cE5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwQ2FyZERlbGV0ZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuRGVmYXVsdCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0bkRlZmF1bHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbEljb24iLCJoYW5kbGVGYXZJY29uIiwiaGFuZGxlRGlzbGlrZSIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsSWNvbiIsIl9oYW5kbGVGYXZJY29uIiwiX2hhbmRsZURpc2xpa2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEZhdkljb24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmREZWxJY29uIiwiX2NhcmRJbWFnZUVsIiwidG9nZ2xlRmF2SWNvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsImdldElkIiwiZ2V0VmlldyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlRWwiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImFkZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRFbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJBcnJheSIsImZyb20iLCJzb21lIiwiX2Rpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVTdWJtaXRCdXR0b24iLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX3N1Ym1pdEJ0biIsIl9zdWJtaXRCdG5EZWZhdWx0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJyZXNldCIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1EYXRhIiwiaW5wdXQiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJlZGl0Rm9ybUVsIiwiZm9ybXMiLCJhZGRGb3JtRWwiLCJhdmF0YXJGb3JtRWwiLCJwcm9maWxlQXZhdGFyQnRuIiwicHJvZmlsZUVkaXRCdG4iLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJjYXJkQWRkQnRuIiwidXNlckluZm8iLCJwcm9maWxlTmFtZVNlbGVjdG9yIiwicHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3IiLCJwcm9maWxlQXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsIiwiX2Rlc2NyaXB0aW9uRWwiLCJfYXZhdGFyRWwiLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwiYXZhdGFyIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiYXBpIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9yZXNWYWxpZGF0ZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJpbmZvIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJnZXRVc2VyQXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkQ2FyZCIsImRhdGEiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsImRlbGV0ZUxpa2UiLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiZWxlbWVudCIsImFwcGVuZCIsImFkZEl0ZW0iLCJwcmVwZW5kIiwiY2FyZEVsIiwicG9wdXBXaXRoSW1hZ2UiLCJjYXJkSW5zdGFuY2UiLCJjYXJkRGVsZXRlUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJhYm91dCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsInByb2ZpbGVBdmF0YXJWYWxpZGF0b3IiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cE5hbWUiLCJuZXdDYXJkUG9wdXAiLCJhdmF0YXJFZGl0UG9wdXAiLCJ1cmwiLCJwcm9maWxlRWRpdFBvcHVwIiwidmFsdWVzIl0sInNvdXJjZVJvb3QiOiIifQ==